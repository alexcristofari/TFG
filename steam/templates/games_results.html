<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suas Recomendações de Jogos</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --theme-primary: #66c0f4; --theme-background: #101821; --theme-card-background: #1b2838;
            --theme-card-hover: #2a475e; --theme-text-primary: #ffffff; --theme-text-secondary: #c7d5e0;
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--theme-background  ); color: var(--theme-text-secondary); margin: 0; padding: 2rem; }
        .container { max-width: 1400px; margin: 0 auto; }
        header h1 { font-size: 2.2rem; text-align: center; margin-bottom: 3rem; color: var(--theme-text-primary); }
        h2 { font-size: 1.8rem; color: var(--theme-text-primary); border-bottom: 1px solid var(--theme-card-hover); padding-bottom: 0.5rem; margin-bottom: 1.5rem; }
        .profile-section { background-color: var(--theme-card-background); margin-bottom: 3rem; padding: 1.5rem; border-radius: 8px; }
        .profile-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 1rem; }
        .profile-header h2 { border-bottom: none; margin: 0; font-size: 1.2rem; }
        .profile-badges { display: flex; gap: 0.75rem; }
        .badge { padding: 0.6rem 1.2rem; border-radius: 500px; font-weight: 700; font-size: 0.9rem; }
        .badge.dominant { background-color: var(--theme-primary); color: var(--theme-background); }
        .badge.exploring { border: 2px solid var(--theme-primary); color: var(--theme-primary); }
        .profile-list { display: flex; flex-wrap: wrap; gap: 0.75rem; }
        .profile-item { background-color: var(--theme-card-hover); padding: 0.5rem 1rem; border-radius: 500px; font-size: 0.9rem; }
        .recommendation-section { margin-bottom: 3rem; }
        .grid-container { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 1.5rem; }
        .card { background-color: var(--theme-card-background); border-radius: 8px; transition: background-color 0.2s; position: relative; text-decoration: none; color: var(--theme-text-primary); overflow: hidden; }
        .card:hover { background-color: var(--theme-card-hover); }
        .card-img-wrapper { position: relative; }
        .card-img { width: 100%; padding-bottom: 56.25%; background-color: var(--theme-card-hover); background-size: cover; background-position: center; border-top-left-radius: 8px; border-top-right-radius: 8px; }
        .card-content { padding: 1rem; }
        .card-title { font-weight: 700; font-size: 1.1rem; display: block; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: 0.25rem; }
        .card-subtitle { font-size: 0.9rem; color: var(--theme-text-secondary); }
        .recommendation-card-score { position: absolute; top: 0.75rem; right: 0.75rem; background-color: rgba(16, 24, 33, 0.7); color: var(--theme-primary); padding: 0.3rem 0.6rem; border-radius: 4px; font-weight: 700; font-size: 0.9rem; border: 1px solid rgba(255, 255, 255, 0.1); backdrop-filter: blur(4px); }
        .back-link { display: inline-block; margin: 2rem auto; padding: 1rem 2rem; background-color: var(--theme-primary); color: var(--theme-background); text-decoration: none; border-radius: 500px; font-weight: 700; transition: transform 0.2s; }
        .back-link:hover { transform: scale(1.05); }
    </style>
</head>
<body>
    <div class="container">
        <header><h1>Suas Recomendações de Jogos</h1></header>

        {% if profile %}
        <section class="profile-section">
            <div class="profile-header">
                <h2>Seu Perfil de Jogos</h2>
                <div class="profile-badges">
                    {% if profile.dominant_genre %}<div class="badge dominant">Gênero Dominante: {{ profile.dominant_genre }}</div>{% endif %}
                    {% if selected_genre %}<div class="badge exploring">Explorando: {{ selected_genre }}</div>{% endif %}
                </div>
            </div>
            <div class="profile-list">
                {% for game in profile.games %}<div class="profile-item">{{ game.name }}</div>{% endfor %}
            </div>
        </section>
        {% endif %}
        
        <!-- Renderiza as seções dinamicamente -->
        {% for category, recs in recommendations.items() if recs %}
        <section class="recommendation-section">
            <h2>{{ category }}</h2>
            <div class="grid-container">
                {% for rec in recs %}
                <a href="https://store.steampowered.com/app/{{ rec.appid }}" target="_blank" class="card">
                    <div class="card-img-wrapper">
                        <div class="card-img" style="background-image: url('{{ rec.header_image }}'  );"></div>
                    </div>
                    <div class="card-content">
                        <strong class="card-title">{{ rec.name }}</strong>
                        <span class="card-subtitle">{{ (rec.developers or ['N/A'])[0] }}</span>
                    </div>
                    {% if rec.similarity_score %}<div class="recommendation-card-score">{{ rec.similarity_score }}%</div>{% endif %}
                </a>
                {% endfor %}
            </div>
        </section>
        {% endfor %}

        <div style="text-align: center;">
            <a href="{{ home_url }}" class="back-link">Fazer Nova Recomendação</a>
        </div>
    </div>
</body>
</html>
